# دليل إدارة المستخدمين - PEMS

## نظرة عامة
تم إضافة نظام شامل لإدارة المستخدمين يسمح للمدير المالي بإضافة وتعديل وحذف المستخدمين مع تحديد صلاحياتهم.

## الوصول إلى صفحة إدارة المستخدمين

### من القائمة الرئيسية
- انقر على "المستخدمين" في شريط التنقل العلوي
- متاح فقط للمدير المالي

### من لوحة التحكم
- انقر على بطاقة "إدارة المستخدمين" في قسم الإجراءات السريعة
- أو انقر على بطاقة إحصائيات المستخدمين

## الميزات الرئيسية

### 1. عرض قائمة المستخدمين
- عرض جميع المستخدمين في جدول منظم
- معلومات كل مستخدم:
  - الاسم مع أيقونة ملونة
  - البريد الإلكتروني
  - الصلاحية (مع ألوان مميزة)
  - الموقع
  - تاريخ الإنشاء
- أزرار الإجراءات (تعديل/حذف)

### 2. إضافة مستخدم جديد
انقر على زر "إضافة مستخدم جديد" وأدخل:
- **الاسم الكامل** (مطلوب)
- **البريد الإلكتروني** (مطلوب - يجب أن يكون فريداً)
- **كلمة المرور** (مطلوب - 8 أحرف على الأقل)
- **الصلاحية** (مطلوب - اختر من القائمة)
- **الموقع** (اختياري)

### 3. تعديل مستخدم
- انقر على أيقونة التعديل بجانب المستخدم
- يمكنك تعديل جميع البيانات
- كلمة المرور اختيارية (اتركها فارغة للإبقاء على القديمة)
- عرض معلومات الحساب (تاريخ الإنشاء والتحديث)

### 4. حذف مستخدم
- انقر على أيقونة الحذف
- تأكيد الحذف
- لا يمكن حذف حسابك الخاص

## الصلاحيات المتاحة

### 1. المدير المالي العام (financial_manager)
**الصلاحيات:**
- كامل الصلاحيات على النظام
- إنشاء وتعديل وحذف المشاريع
- الموافقة على جميع المصروفات والعهد
- عرض جميع التقارير المالية
- إدارة الميزانيات والتخصيصات
- تصدير البيانات
- إدارة المستخدمين

**اللون:** بنفسجي

### 2. محاسب الإدارة (admin_accountant)
**الصلاحيات:**
- عرض جميع المشاريع والمصروفات
- الموافقة على المصروفات والعهد
- إنشاء وتعديل المصروفات
- عرض التقارير المالية
- إدارة المواقع والأشخاص

**اللون:** أزرق

### 3. مدير إنتاج الموقع (production_manager)
**الصلاحيات:**
- إدارة مشاريع محددة
- إنشاء وتعديل المصروفات
- طلب العهد
- عرض تقارير المشاريع الخاصة
- الموافقة على مصروفات الفريق

**اللون:** أخضر

### 4. المحاسب الميداني (field_accountant)
**الصلاحيات:**
- إنشاء المصروفات
- طلب العهد
- عرض المشاريع المخصصة
- تسجيل المصروفات الميدانية

**اللون:** أصفر

### 5. مساعد مالي (financial_assistant)
**الصلاحيات:**
- إنشاء المصروفات
- عرض المشاريع المخصصة
- تسجيل البيانات الأساسية

**اللون:** رمادي

## عرض الصلاحيات التفاعلي

عند اختيار صلاحية في صفحة الإضافة أو التعديل:
- يظهر صندوق أزرق يعرض جميع صلاحيات هذا الدور
- يساعد في اتخاذ القرار الصحيح عند تعيين الصلاحيات

## التصميم والواجهة

### الألوان المميزة
- كل صلاحية لها لون مميز في الجدول
- أيقونات ملونة للمستخدمين (أول حرف من الاسم)
- تأثيرات hover جذابة

### التفاعلية
- تأثيرات انتقالية سلسة
- رسائل تأكيد قبل الحذف
- رسائل نجاح/خطأ واضحة
- تصميم متجاوب يعمل على جميع الأجهزة

## الأمان

### الحماية المطبقة
- الوصول محصور على المدير المالي فقط
- التحقق من صحة البيانات المدخلة
- تشفير كلمات المرور
- منع حذف الحساب الشخصي
- التحقق من فرادة البريد الإلكتروني

### Middleware المستخدم
```php
Route::middleware('role:financial_manager')->group(function () {
    Route::resource('users', UserController::class);
});
```

## المسارات (Routes)

| المسار | الوظيفة |
|--------|---------|
| `/users` | عرض قائمة المستخدمين |
| `/users/create` | صفحة إضافة مستخدم |
| `/users/{user}/edit` | صفحة تعديل مستخدم |
| `POST /users` | حفظ مستخدم جديد |
| `PUT /users/{user}` | تحديث مستخدم |
| `DELETE /users/{user}` | حذف مستخدم |

## الملفات المضافة

### Controller
- `app/Http/Controllers/UserController.php`

### Views
- `resources/views/users/index.blade.php` - قائمة المستخدمين
- `resources/views/users/create.blade.php` - إضافة مستخدم
- `resources/views/users/edit.blade.php` - تعديل مستخدم

### Routes
- تم التحديث في `routes/web.php`

### Navigation
- تم التحديث في `resources/views/layouts/navigation.blade.php`

### Dashboard
- تم التحديث في `resources/views/dashboard.blade.php`

## نصائح الاستخدام

### عند إضافة مستخدم جديد
1. اختر الصلاحية المناسبة بعناية
2. استخدم بريد إلكتروني صحيح وفريد
3. اختر كلمة مرور قوية (8 أحرف على الأقل)
4. حدد الموقع إذا كان المستخدم ميداني

### عند تعديل مستخدم
1. راجع الصلاحيات الحالية قبل التغيير
2. اترك كلمة المرور فارغة إذا لم ترغب في تغييرها
3. تحقق من معلومات الحساب (تاريخ الإنشاء/التحديث)

### أفضل الممارسات
- راجع قائمة المستخدمين بشكل دوري
- احذف الحسابات غير النشطة
- تأكد من صحة الصلاحيات لكل مستخدم
- استخدم أسماء واضحة ومعبرة

## الدعم الفني

في حالة وجود أي مشاكل:
1. تحقق من صلاحياتك (يجب أن تكون مدير مالي)
2. تأكد من صحة البيانات المدخلة
3. راجع رسائل الخطأ المعروضة
4. تواصل مع فريق الدعم الفني

---

**تم التطوير بواسطة:** فريق PEMS
**التاريخ:** 2025
**الإصدار:** 1.0
